@model HotelPortal.Models.Hotel

@{
    ViewData["Title"] = "Details";
}


<head>
    <meta name="viewport" content="width=device-width" />
    <title>Details</title>
</head>
<hr />
<div class="row">
    <div style="padding-bottom:15px;">
        <div class="col-sm-1">
            <a asp-action="Index" class="btn btn-default">
                <span class="glyphicon glyphicon-chevron-left"></span>
            </a>
        </div>
        <div class="col-sm-11">
            <h2 style="margin:inherit;">@ViewData.Model.Name</h2>
        </div>
    </div>
    <div class="col-sm-12" style="padding-top:15px">
        @if (ViewBag.ImageIds != null)
        {
            <div class="flex-row row">
                <div class="col-sm-6">
                    <!--Carousel ugly but works...-->
                    <div class="flex-row thumbnail">
                        <div class="carousel" id="imagescar">
                            <div class="carousel-indicators">
                                @if (true)
                                {
                                    int i = 0;
                                    foreach (var id in ViewBag.ImageIds)
                                    {
                                        if (i == 0)
                                        {
                                            <li data-target="imagescar" data-slide-to="@i" class="active"></li>
                                        }
                                        else
                                        {
                                            <li data-target="imagescar" data-slide-to="@i"></li>
                                        }
                                        i++;
                                    }
                                }
                            </div>
                            <div class="carousel-inner" role="listbox" style="width:100%; height:300px">
                                @if (true)
                                {
                                    int i = 0;
                                    foreach (var id in ViewBag.ImageIds)
                                    {
                                        if (i != 0)
                                        {
                                            <input name="imageIDs" value="id" type="hidden">
                                            <div class="item">
                                                <img class="contentImage" src="@Url.Action("HotelImage", new {imageId = id})" />
                                            </div>
                                        }
                                        else
                                        {
                                            <input name="imageIDs" value="id" type="hidden">
                                            <div class="item active">
                                                <img class="contentImage" src="@Url.Action("HotelImage", new {imageId = id})" />
                                            </div>
                                        }
                                        i++;
                                    }
                                    if (i == 0)
                                    {
                                        <div class="item active">
                                            <img class="contentImage" src="~/images/no_image.jpg" style="height:300px;" />
                                        </div>
                                    }
                                }

                            </div>
                            <a class="left carousel-control" href="#imagescar" role="button" data-slide="prev">
                                <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                                <span class="sr-only">Previous</span>
                            </a>
                            <a class="right carousel-control" href="#imagescar" role="button" data-slide="next">
                                <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                                <span class="sr-only">Next</span>
                            </a>
                        </div>
                    </div>
                </div>
                <!--Desctiprion-->
                <div class="col-sm-6">
                    <h3>@ViewData.Model.City.Name</h3>
                    <div style="padding-bottom:10px;">
                        @for (int i = 0; i < ViewData.Model.Stars; i++)
                        {
                            <span class="glyphicon glyphicon-star"></span>
                        }
                    </div>
                    <div class="col-sm-pull-12" style="width:100%;">
                        <div class="panel panel-info" style="padding-bottom:15px; height:250px; width:100%;">
                            <div class="panel panel-heading" style="padding-bottom:5px;padding-top:5px;">
                                @if (User.IsInRole("Admin"))
                                {
                                    <div class="row">
                                        <div class="col-sm-9">
                                            <label style="padding-top:6px;">Description </label>
                                        </div>
                                        <div class="col-sm-3">
                                            <a class="btn btn-primary btn-block" asp-action="Edit" asp-route-id="@Model.Id">Edit</a>
                                        </div>
                                    </div>                                   
                                }
                            </div>
                            <div class="flex-text">
                                <p class="panel-body" style="border-radius:5px;">@Model.Description</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>
</div>
<hr />
<div class="row">
    <div class="col-sm-8">
        <h2>Rooms</h2>
        @foreach (Room room in Model.Rooms)
        {
            <div class="panel panel-default">
                <div class="panel-body">
                    <div class="row">
                        <div class="col-sm-3">
                            <img class="contentImage" src="@Url.Action("RoomMainImage","Rooms", new {parentId = room.Id})" width="100" height="100" />
                        </div>
                        <div class="col-sm-6">
                            <h3>Capacity: <span class="label label-default">@room.Capacity</span></h3>
                            <h3>Price: <span class="label label-default">@room.Price HUF</span></h3>
                        </div>
                        <div class="col-sm-3">
                            <a class="btn btn-primary btn-block btn-xs" style="margin-top:20px; margin-bottom:10px; font-size:17px;"
                               asp-action="Details" asp-controller="Rooms" asp-route-id="@room.Id">View details</a>
                            <a class="btn btn-primary btn-block btn-xs" style="margin-top:20px; margin-bottom:10px; font-size:17px;"
                               asp-controller="Bookings" asp-action="Create" asp-route-id="@room.Id">Reserve</a>
                        </div>                      
                    </div>
                </div>
                @if (User.IsInRole("Admin"))
                {
                    <a class="btn btn-default btn-block" asp-action="Edit" asp-controller="Rooms" asp-route-id="@room.Id">Edit</a>
                }
            </div>
        }

    </div>
    <div class="col-sm-4">
        <h2>Reviews</h2>
        @if (User.IsInRole("Admin") || User.IsInRole("User"))
        {
            <div class="col-sm-6" style="padding-bottom:15px;padding-left:0px">
                <a class="btn btn-primary btn-block" asp-controller="Reviews" asp-action="Create" asp-route-hotelId="@Model.Id">Write a Review</a>
            </div>
        }
        @if (ViewBag.Reviews != null)
        {
            foreach (var r in ViewBag.Reviews)
            {
                <div class="col-sm-12" style="padding-left:0px">
                    <div class="panel panel-default">
                        <div class="panel panel-heading">
                            <label class="label label-default">
                                @r.Stars
                                <span class="glyphicon glyphicon-star"></span>
                            </label>
                        </div>
                        <div class="panel panel-body">
                            <p>@r.Description</p>
                        </div>
                        @if (User.IsInRole("Admin"))
                        {
                            <input class="btn btn-default btn-block" value="Remove review" onclick="location.href='@Url.Action("Delete", "Reviews", new {id = r.Id})'" />
                        }
                    </div>
                </div>
            }
        }
    </div>
</div>
